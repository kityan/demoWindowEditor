"use strict";!function(){function e(e,t){e.modelData=t.models[0].data}function t(e,t,r,n){var i="ontouchstart"in window||navigator.MaxTouchPoints>0||navigator.msMaxTouchPoints>0;i?n.options({trigger:"dontTrigger"}):n.options({trigger:"mouseenter"}),t.otherwise("/"),e.state("main",{url:"/",views:{nav:{templateUrl:"views/nav.tpl.html",controller:"NavController"},main:{templateUrl:"views/main.tpl.html",controller:"MainController"}}}).state("templates",{url:"/templates",views:{nav:{templateUrl:"views/nav.tpl.html",controller:"NavController"},main:{templateUrl:"views/templates.tpl.html",controller:"TemplatesController"}}}).state("model",{url:"/model",views:{nav:{templateUrl:"views/nav.tpl.html",controller:"NavController"},main:{templateUrl:"views/model.tpl.html",controller:"MainController"}}})}angular.module("app",["app-templates","ui.router","ui.bootstrap","ui.bootstrap.contextMenu"]).config(["$stateProvider","$urlRouterProvider","$sceDelegateProvider","$uibTooltipProvider",t]).run(["CurrentModel","ModelsExamples",e])}(),function(){function e(e){function t(t,n){var i=[function(e,n,i,a,s){return"<strong>"+r[t._refs[i].type]+"</strong>"},angular.noop,function(){return!1}],a=function(r){return["раму",function(i,a,s){e[r](t._refs[s],{type:"frame"}),n()}]},s=function(r){return["импост",[["вертикальный",function(i,a,s){e[r](t._refs[s],{type:"impost",direction:"vertical"}),n()}],["горизонтальный",function(i,a,s){e[r](t._refs[s],{type:"impost",direction:"horizontal"}),n()}]]]},o=function(r){return["створку",[["поворотную левую",function(i,a,s){e[r](t._refs[s],{type:"sash",handleSide:"left"}),n()}],["поворотную правую",function(i,a,s){e[r](t._refs[s],{type:"sash",handleSide:"right"}),n()}],["поворотную верхнюю",function(i,a,s){e[r](t._refs[s],{type:"sash",handleSide:"top"}),n()}],["поворотную нижнюю",function(i,a,s){e[r](t._refs[s],{type:"sash",handleSide:"bottom"}),n()}],["поворотно-откидную левую",function(i,a,s){e[r](t._refs[s],{type:"sash",handleSide:"left",tilt:!0}),n()}],["поворотно-откидную правую",function(i,a,s){e[r](t._refs[s],{type:"sash",handleSide:"right",tilt:!0}),n()}]]]},p=function(r){return["стеклопакет",function(i,a,s){e[r](t._refs[s],{type:"glass"}),n()}]};return function(e){return[i,null,[].concat("aperture"==t._refs[e].type?["вставить",angular.noop,[].concat(t._refs[e].isRootAperture?[a("insert")]:[]).concat(t._refs[e].isRootAperture?[]:[s("insert"),o("insert"),p("insert")])]:"frame"==t._refs[e].type?[[]]:["заменить на",angular.noop,[].concat([s("replaceWith"),o("replaceWith"),p("replaceWith")])])]}}var r={aperture:"проём",impost:"импост",frame:"рама",sash:"створка",glass:"стеклопакет"};return{get:t}}angular.module("app").factory("ContextMenu",["NodeActions",e])}(),function(){angular.module("app").factory("CurrentModel",function(){var e={modelData:null,stat:null};return e})}(),function(){angular.module("app").constant("ModelsExamples",{models:[{name:"Пустой проём 1900×1000",data:{formatVersion:1,aperture:{properties:{size:{vertical:1e3,horizontal:1900}},content:null}}},{name:"Только квадратная рама 1000×1000",data:{formatVersion:1,aperture:{properties:{size:{vertical:1e3,horizontal:1e3}},content:{type:"frame",properties:{sizes:{heightFront:48,heightRear:68,beadHeight:18}},aperture:{}}}}},{name:"Квадратная рама 1000×1000 с остеклением",data:{formatVersion:1,aperture:{properties:{size:{vertical:1e3,horizontal:1e3}},content:{type:"frame",properties:{sizes:{heightFront:48,heightRear:68,beadHeight:18}},aperture:{content:{type:"glass"}}}}}},{name:"Квадратная рама 1000×1000 со створкой с остеклением",data:{formatVersion:1,aperture:{properties:{size:{vertical:1e3,horizontal:1e3}},content:{type:"frame",properties:{sizes:{heightFront:48,heightRear:68,beadHeight:18}},aperture:{content:{type:"sash",properties:{handleSide:"left",tilt:!0,sizes:{labelPadding:20,heightFront:52,heightRear:72,overlap:8,beadHeight:18}},aperture:{content:{type:"glass"}}}}}}}},{name:"Рама 2000×1500 с импостом со смещением",data:{formatVersion:1,aperture:{properties:{size:{vertical:1500,horizontal:2e3}},content:{type:"frame",properties:{sizes:{heightFront:48,heightRear:68,beadHeight:18}},aperture:{content:{type:"impost",properties:{offset:-200,direction:"vertical",sizes:{heightFront:48,heightRear:88,beadHeight:18}},aperture:[{side:"left"},{side:"right"}]}}}}}},{name:"Рама 2000×1500 с тремя импостами со смещением",data:{formatVersion:1,aperture:{properties:{size:{vertical:1500,horizontal:2e3}},content:{type:"frame",properties:{sizes:{heightFront:48,heightRear:68,beadHeight:18}},aperture:{content:{type:"impost",properties:{offset:-200,direction:"vertical",sizes:{heightFront:48,heightRear:88,beadHeight:18}},aperture:[{side:"left",content:{type:"impost",properties:{offset:200,direction:"horizontal",sizes:{heightFront:48,heightRear:88,beadHeight:18}},aperture:[{side:"top"},{side:"bottom"}]}},{side:"right",content:{type:"impost",properties:{offset:100,direction:"horizontal",sizes:{heightFront:48,heightRear:88,beadHeight:18}},aperture:[{side:"top"},{side:"bottom"}]}}]}}}}}},{name:"Рама с двумя створками без остекления 2000×1500",data:{formatVersion:1,aperture:{properties:{size:{vertical:1500,horizontal:2e3}},content:{type:"frame",properties:{sizes:{heightFront:48,heightRear:68,beadHeight:18}},aperture:{content:{type:"impost",properties:{offset:0,direction:"vertical",sizes:{heightFront:48,heightRear:88,beadHeight:18}},aperture:[{side:"left",content:{type:"sash",properties:{handleSide:"right",sizes:{labelPadding:20,heightFront:52,heightRear:72,overlap:8,beadHeight:18}},aperture:{}}},{side:"right",content:{type:"sash",properties:{handleSide:"left",tilt:!1,sizes:{labelPadding:20,heightFront:52,heightRear:72,overlap:8,beadHeight:18}},aperture:{}}}]}}}}}},{name:"Глухое окно и две створки 2800×1600",data:{formatVersion:1,aperture:{properties:{size:{vertical:1600,horizontal:2800}},content:{type:"frame",properties:{sizes:{heightFront:48,heightRear:68,beadHeight:18}},aperture:{content:{type:"impost",properties:{offset:-100,direction:"vertical",sizes:{heightFront:48,heightRear:88,beadHeight:18}},aperture:[{side:"left",content:{type:"impost",properties:{offset:0,direction:"vertical",sizes:{heightFront:48,heightRear:88,beadHeight:18}},aperture:[{side:"left",content:{type:"glass",properties:{sizes:{beadHeight:18}}}},{side:"right",content:{type:"sash",properties:{handleSide:"top",sizes:{labelPadding:20,heightFront:52,heightRear:72,overlap:8,beadHeight:18}},aperture:{content:{type:"glass",properties:{sizes:{beadHeight:18}}}}}}]}},{side:"right",content:{type:"sash",properties:{handleSide:"left",tilt:!0,sizes:{labelPadding:20,heightFront:52,heightRear:72,overlap:8,beadHeight:18}},aperture:{content:{type:"glass",properties:{sizes:{}}}}}}]}}}}}},{name:"Много всего",data:{formatVersion:1,aperture:{properties:{size:{vertical:1500,horizontal:2e3}},content:{type:"frame",properties:{sizes:{heightFront:48,heightRear:68,beadHeight:18}},aperture:{content:{type:"impost",properties:{offset:-200,direction:"vertical",sizes:{heightFront:48,heightRear:88,beadHeight:18}},aperture:[{side:"left",content:{type:"impost",properties:{offset:200,direction:"horizontal",sizes:{heightFront:48,heightRear:88,beadHeight:18}},aperture:[{side:"top",content:{type:"glass",properties:{sizes:{}}}},{side:"bottom",content:{type:"sash",properties:{handleSide:"top",tilt:!1,sizes:{labelPadding:20,heightFront:52,heightRear:72,overlap:8,beadHeight:18}},aperture:{content:{type:"glass",properties:{sizes:{}}}}}}]}},{side:"right",content:{type:"impost",properties:{offset:-300,direction:"horizontal",sizes:{heightFront:48,heightRear:88,beadHeight:18}},aperture:[{side:"top",content:{type:"sash",properties:{handleSide:"bottom",tilt:!1,sizes:{labelPadding:20,heightFront:52,heightRear:72,overlap:8,beadHeight:18}},aperture:{content:{type:"glass",properties:{sizes:{}}}}}},{side:"bottom",content:{type:"sash",properties:{handleSide:"right",tilt:!0,sizes:{labelPadding:20,heightFront:52,heightRear:72,overlap:8,beadHeight:18}},aperture:{content:{type:"impost",properties:{offset:0,direction:"horizontal",sizes:{heightFront:48,heightRear:88,beadHeight:18}},aperture:[{side:"top",content:{type:"sash",properties:{handleSide:"left",tilt:!1,sizes:{labelPadding:20,heightFront:52,heightRear:72,overlap:8,beadHeight:18}},aperture:{content:{type:"glass",properties:{sizes:{}}}}}},{side:"bottom",content:{type:"glass",properties:{sizes:{}}}}]}}}}]}}]}}}}}}]})}(),function(){angular.module("app").factory("NodeActions",function(){var e={replaceWith:function(e,t){this.insert(e._parent,t)},insert:function(e,t){switch(t.type){case"frame":e.content={type:t.type,properties:{sizes:{heightFront:48,heightRear:68,beadHeight:18}},aperture:{}};break;case"sash":e.content={type:t.type,properties:{handleSide:t.handleSide||"left",tilt:!!t.tilt,sizes:{labelPadding:20,heightFront:52,heightRear:72,overlap:8,beadHeight:18}},aperture:{}};break;case"impost":e.content={type:t.type,properties:{offset:0,direction:t.direction||"vertical",sizes:{heightFront:48,heightRear:88,beadHeight:18}},aperture:"horizontal"==t.direction?[{side:"top"},{side:"bottom"}]:[{side:"left"},{side:"right"}]};break;case"glass":e.content={type:t.type}}}};return e})}(),function(){function e(){return{restrict:"E",templateUrl:"directives/svgRenderer/svgRenderer.tpl.html",replace:!0,scope:{model:"=",stat:"=",modelOut:"=?",thumb:"<?"},controller:["$scope","$compile","$element","ContextMenu",function(e,r,i,a){function s(){e.stat=t(o,i,!e.thumb),e.modelOut=n(o),e.thumb||r(i.contents())(e)}var o;e.thumb&&i.addClass("thumb"),e.$watch("model",function(){e.model&&(o=angular.copy(e.model),e.menuOptions=a.get(o,s),s())})}]}}function t(e,t,n){function i(e,t,r){var n=s(t,r);if(e.appendChild(n),t.content){var a=o(t.content,t);n.appendChild(a.pre),t.content.aperture&&(Array.isArray(t.content.aperture)?t.content.aperture.forEach(function(e){i(n,e)}):i(n,t.content.aperture)),a.post&&n.appendChild(a.post)}}function a(e){if(!e._parent)return{translation:{x:0,y:0},points:[{x:0,y:0},{x:e.properties.size.horizontal,y:0},{x:e.properties.size.horizontal,y:e.properties.size.vertical},{x:0,y:e.properties.size.vertical}]};var t=e._parent,r=a(t._parent).points,n=t.properties.sizes.heightFront;if("impost"==t.type){if("vertical"==t.properties.direction){var i=t.properties.offset,s="left"==e.side;return{points:[{x:0,y:0},{x:(s?i:-i)+(r[1].x-n)/2,y:0},{x:(s?i:-i)+(r[2].x-n)/2,y:r[2].y},{x:0,y:r[2].y}],translation:{x:s?0:i+(r[1].x+n)/2,y:0}}}var i=t.properties.offset,o="top"==e.side;return{points:[{x:0,y:0},{x:r[1].x,y:0},{x:r[1].x,y:(o?i:-i)+(r[2].y-n)/2},{x:0,y:(o?i:-i)+(r[2].y-n)/2}],translation:{x:0,y:o?0:i+(r[2].y+n)/2}}}return{points:[{x:0,y:0},{x:r[1].x-2*n,y:0},{x:r[2].x-2*n,y:r[2].y-2*n},{x:0,y:r[3].y-2*n}],translation:{x:n,y:n}}}function s(e,t){var r=a(e),n=r.points,i=r.translation,s=f();return d3.select(s).attr("transform","translate("+i.x+","+i.y+")").classed("aperture",!0).classed("aperture--empty",!e.content).append("svg:path").attr("d",x(n)+" z").attr("context-menu","menuOptions("+e._ref+")").attr("model",e._ref),t&&d3.select(s).attr("fill","url(#img1)"),s}function o(e,t){var r;switch(e.type){case"frame":r=l(e,t);break;case"glass":r=p(e,t);break;case"sash":r=h(e,t);break;case"impost":r=u(e,t)}return d3.select(r.pre).classed("content--pre",!0).attr("context-menu","menuOptions("+e._ref+")").attr("model",e._ref),d3.select(r.post).classed("content--post",!0),r}function p(e,t){var r=e._parent._parent.properties.sizes.beadHeight,n=a(t).points;m.glass.rects.push({width:n[1].x-n[0].x,height:n[2].y-n[1].y}),m.bead.lengths.push(n[1].x-n[0].x),m.bead.lengths.push(n[1].x-n[0].x),m.bead.lengths.push(n[2].y-n[1].y),m.bead.lengths.push(n[2].y-n[1].y);var i=f();d3.select(i).classed("glass",!0).classed("content",!0).append("svg:path").attr("d",x(n)+" z");var s=[];s.push({side:"top",points:function(e){return[{x:n[0].x+e,y:n[0].y+e},{x:n[1].x-e,y:n[1].y+e},n[1],n[0]]}}),s.push({side:"left",points:function(e){return[{x:n[0].x+e,y:n[0].y+e},{x:n[3].x+e,y:n[3].y-e},n[3],n[0]]}}),s.push({side:"right",points:function(e){return[{x:n[1].x-e,y:n[1].y+e},{x:n[2].x-e,y:n[2].y-e},n[2],n[1]]}}),s.push({side:"bottom",points:function(e){return[{x:n[3].x+e,y:n[3].y-e},{x:n[2].x-e,y:n[2].y-e},n[2],n[3]]}});for(var o=0;o<s.length;o++){var p=f();d3.select(p).classed("bead bead--"+s[o].side,!0).append("svg:path").attr("d",x(s[o].points(r))+" Z").attr("stroke-linejoin","round").attr("vector-effect","non-scaling-stroke"),i.appendChild(p)}return{pre:i}}function l(e,t){var r=f();d3.select(r).classed("frame",!0).classed("content",!0);var n=a(t).points,i=e.properties.sizes.heightRear,s=e.properties.sizes.heightFront;m.frame.lengths.push(n[1].x-n[0].x),m.frame.lengths.push(n[1].x-n[0].x),m.frame.lengths.push(n[2].y-n[1].y),m.frame.lengths.push(n[2].y-n[1].y);var o=[];o.push({side:"top",points:function(e){return[{x:n[0].x+e,y:n[0].y+e},{x:n[1].x-e,y:n[1].y+e},n[1],n[0]]}}),o.push({side:"left",points:function(e){return[{x:n[0].x+e,y:n[0].y+e},{x:n[3].x+e,y:n[3].y-e},n[3],n[0]]}}),o.push({side:"right",points:function(e){return[{x:n[1].x-e,y:n[1].y+e},{x:n[2].x-e,y:n[2].y-e},n[2],n[1]]}}),o.push({side:"bottom",points:function(e){return[{x:n[3].x+e,y:n[3].y-e},{x:n[2].x-e,y:n[2].y-e},n[2],n[3]]}});for(var p=0;p<o.length;p++){var l=f();d3.select(l).classed("beam beam--"+o[p].side,!0).append("svg:path").attr("d",x(o[p].points(i))+" Z").attr("stroke-linejoin","round").attr("vector-effect","non-scaling-stroke"),d3.select(l).append("svg:path").attr("d",x(o[p].points(s))+" Z").attr("stroke-linejoin","round").attr("vector-effect","non-scaling-stroke"),r.appendChild(l)}return{pre:r}}function h(e,t){var r=f();d3.select(r).classed("sash",!0).classed("content",!0);var n=a(t).points;m.sash.qty++,m.sash.lengths.push(n[1].x-n[0].x),m.sash.lengths.push(n[1].x-n[0].x),m.sash.lengths.push(n[2].y-n[1].y),m.sash.lengths.push(n[2].y-n[1].y);var i=[],s=function(e,t){return[{x:n[0].x+e,y:n[0].y+e},{x:n[1].x-e,y:n[1].y+e},{x:n[1].x+t,y:n[1].y-t},{x:n[0].x-t,y:n[0].y-t}]};i.push({side:"top",points:s}),i.push({side:"bottom",points:s});var o=function(e,t){return[{x:n[0].x+e,y:n[0].y+e},{x:n[3].x+e,y:n[3].y-e},{x:n[3].x-t,y:n[3].y+t},{x:n[0].x-t,y:n[0].y-t}]};i.push({side:"left",points:o}),i.push({side:"right",points:o});for(var p=n[1].x,l=n[2].y,h=0;h<i.length;h++){var u=f();d3.select(u).classed("beam beam--"+i[h].side,!0).attr("transform",function(){return"right"==i[h].side?"scale(-1 1) translate(-"+p+", 0)":"bottom"==i[h].side?"scale(1 -1) translate(0, -"+l+")":null}).append("svg:path").attr("d",x(i[h].points(e.properties.sizes.heightRear,e.properties.sizes.overlap))+" Z").attr("stroke-linejoin","round").attr("vector-effect","non-scaling-stroke"),d3.select(u).append("svg:path").attr("d",x(i[h].points(e.properties.sizes.heightFront,e.properties.sizes.overlap))+" Z").attr("stroke-linejoin","round").attr("vector-effect","non-scaling-stroke"),i[h].side==e.properties.handleSide&&u.appendChild(d(i[h],e)),r.appendChild(u)}return{pre:r,post:c(e,n)}}function d(e,n){var i=e.points(n.properties.sizes.heightFront,n.properties.sizes.overlap),a=d3.min(i,function(e){return e.y}),s=d3.max(i,function(e){return e.y}),o=d3.min(i,function(e){return e.x}),p=d3.max(i,function(e){return e.x}),l="bottom"==e.side||"top"==e.side?"handleHorizontal":"handleVertical",h=r(t.find("g"),l).getBBox(),d=(p-o-h.width)/2,c=(s-a-h.height)/2,u=f();return d3.select(u).append("svg:use").attr("xlink:href","#"+l).attr("x",d-n.properties.sizes.overlap).attr("y",c-n.properties.sizes.overlap),u}function c(e,t){var r=e.properties.sizes.heightFront+e.properties.sizes.beadHeight+e.properties.sizes.labelPadding,n={};n.top=n.bottom={labelPoints:[{x:t[3].x+r,y:t[3].y-r},{x:t[1].x/2,y:t[1].y+r},{x:t[2].x-r,y:t[2].y-r}],translateValue:t[2].y-t[1].y},n.right=n.left={labelPoints:[{x:t[0].x+r,y:t[0].y+r},{x:t[1].x-r,y:t[2].y/2},{x:t[3].x+r,y:t[3].y-r}],translateValue:t[2].x-t[3].x};var i=f(),a=d3.select(i).classed("sash--label",!0).append("svg:path").attr("d",x(n[e.properties.handleSide].labelPoints)).attr("stroke-linejoin","round").attr("vector-effect","non-scaling-stroke");return"bottom"==e.properties.handleSide&&a.attr("transform",function(){return"scale(1,-1) translate(0, "+-n[e.properties.handleSide].translateValue+")"}),"left"==e.properties.handleSide&&a.attr("transform",function(){return"scale(-1, 1) translate("+-n[e.properties.handleSide].translateValue+", 0)"}),e.properties.tilt&&d3.select(i).append("svg:path").attr("d",x(n.top.labelPoints)).attr("stroke-linejoin","round").attr("vector-effect","non-scaling-stroke"),i}function u(e,t){var r=f();d3.select(r).classed("impost",!0).classed("content",!0);var n=f(),i=a(t).points;m.impost.qty++,m.impost.lengths.push("vertical"==e.direction?i[2].y-i[1].y:i[1].x-i[0].x);var s=e.properties.sizes.heightRear,o=e.properties.sizes.heightFront,p=e.properties.offset,l=(s-o)/2;if("vertical"==e.properties.direction)var h=function(e,t,r){return[{x:r+i[1].x/2-e/2,y:i[1].y+t},{x:r+i[1].x/2+e/2,y:i[1].y+t},{x:r+i[1].x/2+e/2,y:i[2].y-t},{x:r+i[1].x/2-e/2,y:i[2].y-t}]};else var h=function(e,t,r){return[{x:i[0].x+t,y:r+i[2].y/2-e/2},{x:i[0].x+t,y:r+i[2].y/2+e/2},{x:i[1].x-t,y:r+i[2].y/2+e/2},{x:i[1].x-t,y:r+i[2].y/2-e/2}]};return d3.select(n).classed("beam beam--vertical",!0).append("svg:path").attr("d",x(h(s,l,p))+" Z").attr("stroke-linejoin","round").attr("vector-effect","non-scaling-stroke"),d3.select(n).append("svg:path").attr("d",x(h(o,0,p))+" Z").attr("stroke-linejoin","round").attr("vector-effect","non-scaling-stroke"),r.appendChild(n),{pre:r}}function g(e){function t(e,i,a){if(i){i._parent=a,n(e,i),r(i);for(var s in i)"content"!=s&&"aperture"!=s||("aperture"==s&&Array.isArray(i[s])?i[s].forEach(function(r){t(e,r,i)}):t(e,i[s],i))}}function r(e){null==e._parent?(e.type="aperture",e.isRootAperture=!0):e._parent.content||(e.type="aperture")}function n(e,t){t._ref=e._refs.length,e._refs.push(t)}e._refs=[],t(e,e.aperture,null)}function f(){return document.createElementNS("http://www.w3.org/2000/svg","g")}function y(){return{frame:{lengths:[]},impost:{qty:0,lengths:[]},sash:{qty:0,lengths:[]},bead:{lengths:[]},glass:{rects:[]}}}var m=y();g(e);var x=d3.svg.line().x(function(e){return e.x}).y(function(e){return e.y}).interpolate("linear"),v=t[0].clientWidth||t[0].parentNode.clientWidth,b=t[0].clientHeight||t[0].parentNode.clientHeight,z=d3.max([e.aperture.properties.size.horizontal,e.aperture.properties.size.vertical]),R=1,F=[{max:500,scale:.7},{max:800,scale:.5},{max:1e3,scale:.4},{max:1400,scale:.35},{max:1900,scale:.25},{max:2200,scale:.2},{max:3e3,scale:.16}];F.forEach(function(e){R=z>e.max?e.scale:R}),v<=200&&(R/=4),d3.select(t[0]).selectAll(".svgPatternImg").attr("width",20/R).attr("height",20/R),d3.select(t[0]).selectAll(".svgPatternImg image").attr("width",20/R).attr("height",20/R);for(var H=r(t.find("g"),"view");H.firstChild;)H.removeChild(H.firstChild);return d3.select(H).attr("transform",function(){return"translate("+Math.round(v/2-e.aperture.properties.size.horizontal*R/2)+","+Math.round(b/2-e.aperture.properties.size.vertical*R/2)+") scale("+R+")"}),i(H,e.aperture,n),m.frame.totalLength=m.frame.lengths.reduce(function(e,t){return e+t},0),m.sash.totalLength=m.sash.lengths.reduce(function(e,t){return e+t},0),m.bead.totalLength=m.bead.lengths.reduce(function(e,t){return e+t},0),m.impost.totalLength=m.impost.lengths.reduce(function(e,t){return e+t},0),m.glass.totalArea=m.glass.rects.reduce(function(e,t){return e+t.width*t.height},0),m}function r(e,t){for(var r=0;r<e.length;r++){var n;if((n=e[r].getAttribute("class"))&&n.split(" ").indexOf(t)>=0)return e[r]}return null}function n(e){return JSON.parse(JSON.stringify(e,function(e,t){return"_parent"==e||"_ref"==e||"_refs"==e||"isRootAperture"==e?void 0:"type"==e&&"aperture"==t?void 0:t}))}angular.module("app").directive("svgRenderer",[e])}(),function(){function e(e,t){e.modelData=t.modelData,e.$watch("stat",function(){e.stat&&(t.modelData=e.updatedModel)},!0)}angular.module("app").controller("MainController",["$scope","CurrentModel",e])}(),function(){function e(e,t){e.currState=t.current.name}angular.module("app").controller("NavController",["$scope","$state",e])}(),function(){function e(e,t,r,n){e.models=t.models,e.startEditingFromThisTemplate=function(e){n.modelData=e,r.go("main")}}angular.module("app").controller("TemplatesController",["$scope","ModelsExamples","$state","CurrentModel",e])}();